<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PetPetDoc | å…¨æ¸¯ç¸é†«åå–®</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+HK:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Noto Sans HK', sans-serif; background-color: #F8FAFC; }
        .clinic-card { transition: all 0.2s; border: 1px solid #e2e8f0; }
        .clinic-card:hover { border-color: #f97316; }
        
        /* è¨ºæ‰€åé€£çµæ¨£å¼ */
        .clinic-link { color: #f97316; transition: all 0.2s; text-decoration: none; }
        .clinic-link:hover { text-decoration: underline; opacity: 0.8; }
        
        .filter-active { background-color: #f97316 !important; color: white !important; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        #desktopMap { height: calc(100vh - 80px); width: 100%; }
    </style>
</head>
<body class="md:overflow-hidden">

    <header class="sticky top-0 z-[1000] bg-white border-b border-gray-100 shadow-sm">
        <div class="max-w-[1440px] mx-auto p-4 flex items-center justify-between gap-4">
            <div onclick="location.reload()" class="flex items-center gap-1 cursor-pointer min-w-max">
                <span class="text-2xl">ğŸ¾</span>
                <span class="text-xl font-bold text-orange-500">PetPetDoc</span>
            </div>
            
            <div class="relative flex-1 max-w-xl">
                <input type="text" id="mainSearch" onkeyup="filterClinics()" placeholder="æœå°‹è¨ºæ‰€ã€åœ°å€..." 
                    class="w-full bg-gray-100 p-2.5 pl-10 rounded-xl text-sm outline-none focus:ring-2 ring-orange-100">
                <span class="absolute left-3 top-2.5 text-gray-400">ğŸ”</span>
            </div>

            <div class="hidden md:flex gap-2">
                <button id="d-btn24hr" onclick="toggleFilter('24hr')" class="px-4 py-2 rounded-xl text-xs font-bold bg-gray-100 text-gray-600">ğŸ•’ 24å°æ™‚</button>
                <button id="d-btnER" onclick="toggleFilter('ER')" class="px-4 py-2 rounded-xl text-xs font-bold bg-gray-100 text-gray-600">ğŸš¨ æ€¥ç—‡</button>
            </div>
        </div>
    </header>

    <div class="flex flex-col md:flex-row max-w-[1440px] mx-auto h-[calc(100vh-80px)]">
        
        <aside class="w-full md:w-[450px] lg:w-[500px] h-full overflow-y-auto p-4 no-scrollbar">
            <div id="resultsCount" class="text-[10px] text-gray-400 font-bold mb-4 uppercase tracking-widest">æ­£åœ¨è¼‰å…¥åå–®...</div>
            <div id="clinicContainer" class="space-y-4 pb-24 md:pb-4">
                </div>
        </aside>

        <main class="hidden md:block flex-1 bg-gray-100">
            <div id="desktopMap"></div>
        </main>
    </div>

    <nav class="md:hidden fixed bottom-6 left-1/2 -translate-x-1/2 bg-white shadow-2xl rounded-full px-12 py-4 z-[2000] border border-gray-100 flex gap-8">
        <button onclick="location.reload()" class="text-orange-500 font-bold text-xs">ğŸ“‹ åå–®</button>
        <button onclick="alert('åœ°åœ–æ¨¡å¼')" class="text-gray-400 font-bold text-xs">ğŸ“ åœ°åœ–</button>
    </nav>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const clinics = [
            { name: "Pets Central åŒ—è§’", area: "æ¸¯å³¶", address: "åŒ—è§’æ¸£è¯é“70è™Ÿ", phone: "2811 8907", is24hr: true, hasER: true, rating: 4.8, lat: 22.2908, lng: 114.2005 },
            { name: "SPCA ç£ä»”ç¸½éƒ¨", area: "æ¸¯å³¶", address: "ç£ä»”é‹ç››è¡—5è™Ÿ", phone: "2802 0501", is24hr: true, hasER: true, rating: 4.6, lat: 22.2825, lng: 114.1812 },
            { name: "åŸå¤§å‹•ç‰©é†«ç™‚ä¸­å¿ƒ", area: "ä¹é¾", address: "æ·±æ°´åŸ—è”æè§’é“339è™Ÿ", phone: "3650 3000", is24hr: true, hasER: true, rating: 4.7, lat: 22.3364, lng: 114.1485 },
            { name: "NPV éç‰Ÿåˆ©ç¸é†«è¨ºæ‰€", area: "ä¹é¾", address: "å¤ªå­åŸºéš†è¡—22è™Ÿ", phone: "2393 2070", is24hr: true, hasER: false, rating: 4.2, lat: 22.3255, lng: 114.1678 }
        ];

        let filters = { is24hr: false, hasER: false };
        let dMap = null;

        function renderClinics(data) {
            const container = document.getElementById('clinicContainer');
            document.getElementById('resultsCount').innerText = `æ‰¾åˆ° ${data.length} é–“è¨ºæ‰€`;
            
            container.innerHTML = data.map(c => {
                // ç”Ÿæˆ Google æœå°‹é€£çµ
                const googleSearchUrl = `https://www.google.com/search?q=${encodeURIComponent(c.name + ' ' + c.area)}`;
                
                return `
                <div class="clinic-card bg-white p-5 rounded-[22px] shadow-sm flex flex-col gap-3">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <div class="flex items-center gap-2">
                                <a href="${googleSearchUrl}" target="_blank" class="clinic-link font-bold text-lg leading-tight">
                                    ${c.name}
                                </a>
                                ${c.is24hr ? '<span class="bg-red-500 text-white text-[8px] px-1.5 py-0.5 rounded font-bold">24H</span>' : ''}
                            </div>
                            <p class="text-[11px] text-gray-400 mt-1">${c.address}</p>
                            <a href="tel:${c.phone}" class="text-gray-700 font-bold text-sm block mt-2">ğŸ“ ${c.phone}</a>
                        </div>
                        <div class="text-orange-500 font-bold text-xs bg-orange-50 px-2 py-1 rounded-lg">â˜… ${c.rating}</div>
                    </div>
                    <button onclick="focusMap(${c.lat}, ${c.lng})" class="w-full bg-gray-50 py-3 rounded-xl text-[11px] font-bold text-gray-500 border border-gray-100 md:hidden">
                        ğŸ“ æŸ¥çœ‹ä½ç½®
                    </button>
                </div>
            `}).join('');
        }

        // é›»è…¦ç‰ˆåœ°åœ–åˆå§‹åŒ–
        function initMap() {
            if (window.innerWidth >= 768) {
                dMap = L.map('desktopMap', { zoomControl: false }).setView([22.3193, 114.1694], 12);
                L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(dMap);
                clinics.forEach(c => L.marker([c.lat, c.lng]).addTo(dMap).bindPopup(c.name));
            }
        }

        function focusMap(lat, lng) {
            if (dMap) dMap.setView([lat, lng], 16);
            else alert('åœ°åœ–ä½ç½®: ' + lat + ', ' + lng);
        }

        function filterClinics() {
            const q = document.getElementById('mainSearch').value.toLowerCase();
            const filtered = clinics.filter(c => 
                c.name.toLowerCase().includes(q) &&
                (!filters.is24hr || c.is24hr) &&
                (!filters.hasER || c.hasER)
            );
            renderClinics(filtered);
        }

        function toggleFilter(type) {
            filters[type === '24hr' ? 'is24hr' : 'hasER'] = !filters[type === '24hr' ? 'is24hr' : 'hasER'];
            document.getElementById(`d-btn${type === '24hr' ? '24hr' : 'ER'}`).classList.toggle('filter-active');
            filterClinics();
        }

        window.onload = () => { renderClinics(clinics); initMap(); };
    </script>
</body>
</html>
